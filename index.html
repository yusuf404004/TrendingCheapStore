<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TrendingCheapStore</title>
<style>
  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body, html {
    margin:0; padding:0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f5f7fa;
    overflow-x: hidden;
  }
  button {
    cursor: pointer;
  }

  /* Layout */
  #app {
    display: flex;
    min-height: 100vh;
  }

  /* Sidebar */
  #sidebar {
    position: fixed;
    top: 0; left: 0;
    width: 260px;
    height: 100vh;
    background: #222d42;
    color: white;
    padding: 1rem 0;
    transform: translateX(-280px);
    transition: transform 0.3s ease;
    overflow-y: auto;
    z-index: 1100;
  }
  #sidebar.open {
    transform: translateX(0);
  }
  #sidebar h2 {
    font-weight: 700;
    font-size: 1.3rem;
    margin: 0 1.5rem 1rem;
    user-select: none;
  }
  #sidebar section {
    margin-bottom: 1rem;
  }
  #sidebar button.category-btn,
  #sidebar button.subcat-btn,
  #sidebar button.subsubcat-btn {
    display: block;
    width: 90%;
    margin: 0.3rem auto;
    padding: 0.5rem 0.75rem;
    background: transparent;
    border: none;
    color: #cfd8dc;
    font-size: 0.9rem;
    text-align: left;
    border-radius: 4px;
    transition: background-color 0.2s;
  }
  #sidebar button.category-btn:hover,
  #sidebar button.subcat-btn:hover,
  #sidebar button.subsubcat-btn:hover {
    background-color: #455a75;
    color: white;
  }
  #sidebar button.active {
    background-color: #1a73e8;
    color: white;
    font-weight: 700;
  }

  /* Sidebar toggle button top left */
  #sidebarToggle {
    position: fixed;
    top: 10px; left: 10px;
    width: 35px; height: 35px;
    background: #1a73e8;
    border: none;
    border-radius: 5px;
    color: white;
    font-weight: 700;
    font-size: 22px;
    z-index: 1200;
    user-select: none;
  }

  /* Main Content */
  #mainContent {
    margin-left: 0;
    padding: 1rem 1rem 3rem 1rem;
    flex: 1;
    transition: margin-left 0.3s ease;
  }
  #sidebar.open ~ #mainContent {
    margin-left: 260px;
  }

  /* Header with Cart button */
  #header {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    margin-bottom: 1rem;
    gap: 1rem;
  }
  #cartToggle {
    background: #1a73e8;
    border: none;
    padding: 0.4rem 0.8rem;
    border-radius: 5px;
    color: white;
    font-weight: 700;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  #cartToggle.hidden {
    display: none;
  }
  #cartToggle:hover {
    background: #155ab6;
  }

  /* Products grid */
  #products {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
  }
  .product-item {
    background: white;
    border-radius: 6px;
    padding: 0.8rem;
    box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    transition: box-shadow 0.25s ease;
  }
  .product-item:hover {
    box-shadow: 0 6px 12px rgb(0 0 0 / 0.15);
  }
  .product-item img {
    max-width: 100%;
    height: 140px;
    object-fit: contain;
  }
  .product-name {
    margin-top: 0.6rem;
    font-weight: 600;
    text-align: center;
    font-size: 1rem;
  }
  .price {
    margin-top: 0.3rem;
    color: #388e3c;
    font-weight: 700;
    font-size: 1.1rem;
  }

  /* Cart Overlay */
  #cartOverlay {
    position: fixed;
    top: 60px;
    right: 10px;
    width: 350px;
    max-height: 75vh;
    background: white;
    box-shadow: 0 4px 15px rgb(0 0 0 / 0.25);
    border-radius: 8px;
    padding: 1rem;
    overflow-y: auto;
    z-index: 1200;
    display: none;
  }
  #cartOverlay.visible {
    display: block;
  }
  #cartOverlay h3 {
    margin-top: 0;
    margin-bottom: 1rem;
    text-align: center;
  }
  .cart-item {
    display: flex;
    align-items: center;
    margin-bottom: 1rem;
    gap: 0.7rem;
  }
  .cart-item img {
    width: 55px;
    height: 55px;
    object-fit: contain;
    border-radius: 4px;
    border: 1px solid #ddd;
  }
  .cart-item-info {
    flex: 1;
  }
  .cart-item-name {
    font-weight: 600;
    font-size: 0.95rem;
  }
  .cart-item-price {
    color: #388e3c;
    font-weight: 700;
    font-size: 0.9rem;
  }
  .cart-quantity {
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }
  .qty-btn {
    width: 22px;
    height: 22px;
    background: #1a73e8;
    border: none;
    border-radius: 4px;
    color: white;
    font-weight: 700;
    font-size: 18px;
    line-height: 18px;
    padding: 0;
    user-select: none;
  }
  .qty-btn:active {
    background: #155ab6;
  }
  .qty-input {
    width: 45px;
    height: 28px;
    text-align: center;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 1rem;
  }

  /* Checkout & promo */
  #checkoutTotal {
    font-weight: 700;
    font-size: 1.15rem;
    text-align: center;
    margin-top: 1rem;
    color: #111;
  }
  #promoSection {
    margin-top: 1.2rem;
    display: flex;
    justify-content: center;
    gap: 0.6rem;
    align-items: center;
  }
  #promoInput {
    width: 65%;
    padding: 0.4rem 0.6rem;
    font-size: 1rem;
    border: 1px solid #bbb;
    border-radius: 4px;
  }
  #promoBtn {
    background: #388e3c;
    border: none;
    color: white;
    font-weight: 700;
    padding: 0.4rem 0.9rem;
    border-radius: 5px;
    font-size: 1rem;
    user-select: none;
  }
  #promoBtn:hover {
    background: #2c6e2a;
  }
  #promoMsg {
    text-align: center;
    margin-top: 0.7rem;
    font-weight: 600;
  }

  /* Search & filters */
  #filters {
    margin-bottom: 1rem;
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }
  #searchInput {
    padding: 0.5rem 0.7rem;
    font-size: 1rem;
    width: 200px;
    border-radius: 4px;
    border: 1px solid #ccc;
  }
  #priceFilter {
    width: 150px;
  }
  label {
    font-weight: 600;
  }

  /* Responsive */
  @media (max-width: 900px) {
    #products {
      grid-template-columns: repeat(2, 1fr);
    }
    #sidebar.open ~ #mainContent {
      margin-left: 260px;
    }
  }
  @media (max-width: 600px) {
    #products {
      grid-template-columns: 1fr;
    }
    #sidebar {
      width: 220px;
    }
    #sidebar.open ~ #mainContent {
      margin-left: 220px;
    }
  }
</style>
</head>
<body>
<button id="sidebarToggle" aria-label="Toggle menu">&#9776;</button>

<div id="sidebar" aria-label="Sidebar navigation menu" role="navigation" aria-hidden="true">
  <h2>Categories</h2>
  <section>
    <button class="category-btn" id="catVirtual" aria-pressed="false">Virtual</button>
    <div id="virtualSubcats" style="display:none; padding-left: 1rem;">
      <button class="subcat-btn" data-subcat="fortniteAccounts">Fortnite Accounts</button>
      <button class="subcat-btn" data-subcat="vBucks">V-Bucks</button>
    </div>
  </section>
  <section>
    <button class="category-btn" id="catPhysical" aria-pressed="false">Physical</button>
    <div id="physicalSubcats" style="display:none; padding-left: 1rem;">
      <button class="subcat-btn" data-subcat="football">Football</button>
      <button class="subcat-btn" data-subcat="clothing">Clothing</button>
    </div>
    <div id="footballSubsubcats" style="display:none; padding-left: 1.5rem; margin-top: 0.5rem;">
      <button class="subsubcat-btn" data-subsubcat="jerseys">Jerseys</button>
      <button class="subsubcat-btn" data-subsubcat="mysteryBoxes">Mystery Boxes</button>
      <button class="subsubcat-btn" data-subsubcat="sets">Sets</button>
    </div>
    <div id="clothingSubsubcats" style="display:none; padding-left: 1.5rem; margin-top: 0.5rem;">
      <button class="subsubcat-btn" data-subsubcat="socks">Socks</button>
      <button class="subsubcat-btn" data-subsubcat="shirts">Shirts</button>
      <button class="subsubcat-btn" data-subsubcat="tshirts">T-Shirts</button>
      <button class="subsubcat-btn" data-subsubcat="pants">Pants</button>
      <button class="subsubcat-btn" data-subsubcat="shorts">Shorts</button>
      <button class="subsubcat-btn" data-subsubcat="swimShorts">Swimming Shorts</button>
    </div>
  </section>
</div>

<div id="app">
  <main id="mainContent" tabindex="-1" aria-label="Main store content">
    <header id="header">
      <button id="cartToggle" aria-label="Toggle shopping cart">Cart ðŸ›’</button>
    </header>

    <div id="filters" aria-label="Product search and price filter">
      <input type="search" id="searchInput" placeholder="Search products..." aria-label="Search products" />
      <select id="priceFilter" aria-label="Filter by price">
        <option value="all">All Prices</option>
        <option value="0-20">Under $20</option>
        <option value="20-50">$20 - $50</option>
        <option value="50-100">$50 - $100</option>
        <option value="100+">Over $100</option>
      </select>
    </div>

    <section id="products" aria-live="polite" aria-label="Product listings">
      <!-- Products go here -->
    </section>
  </main>
</div>

<!-- Cart overlay -->
<aside id="cartOverlay" aria-label="Shopping cart" role="dialog" aria-modal="true" aria-hidden="true">
  <h3>Your Cart</h3>
  <div id="cartItems" role="list"></div>
  <div id="checkoutTotal" aria-live="polite">Total: $0.00</div>
  <div id="promoSection">
    <input type="text" id="promoInput" placeholder="Promo code" aria-label="Enter promo code" />
    <button id="promoBtn" aria-label="Apply promo code">Apply</button>
  </div>
  <div id="promoMsg" role="alert" aria-live="assertive"></div>
</aside>

<script>
  // Data: Products by category/subcategory/subsubcategory
  const productsData = {
    virtual: {
      fortniteAccounts: [
        { id: 'v1', name: 'FN Account Level 50', price: 45, image: 'https://cdn2.unrealengine.com/fortnite-fnf-fnf2-1920x1080-72e49d1c98c7.jpg' },
        { id: 'v2', name: 'FN Account Level 100', price: 80, image: 'https://cdn2.unrealengine.com/fortnite-fnf-hero-1920x1080-96276b70d381.jpg' }
      ],
      vBucks: [
        { id: 'v3', name: '1,000 V-Bucks', price: 10, image: 'https://fortnite-api.com/images/currency/v-bucks.png' },
        { id: 'v4', name: '5,000 V-Bucks', price: 45, image: 'https://fortnite-api.com/images/currency/v-bucks.png' }
      ]
    },
    physical: {
      football: {
        jerseys: [
          { id: 'f1', name: 'FC Barcelona Jersey', price: 65, image: 'https://upload.wikimedia.org/wikipedia/en/4/47/FC_Barcelona_%282021-22%29.png' },
          { id: 'f2', name: 'Real Madrid Jersey', price: 70, image: 'https://upload.wikimedia.org/wikipedia/en/5/56/Real_Madrid_CF.svg' },
          { id: 'f3', name: 'Galatasaray Jersey', price: 55, image: 'https://upload.wikimedia.org/wikipedia/en/b/b4/Galatasaray_S.K._logo.svg' }
        ],
        mysteryBoxes: [
          { id: 'f4', name: 'Football Mystery Box', price: 30, image: 'https://cdn-icons-png.flaticon.com/512/105/105218.png' }
        ],
        sets: [
          { id: 'f5', name: 'Barcelona Set (Jersey + Socks)', price: 100, image: 'https://upload.wikimedia.org/wikipedia/en/4/47/FC_Barcelona_%282021-22%29.png' },
          { id: 'f6', name: 'Real Madrid Set (Jersey + Shorts)', price: 110, image: 'https://upload.wikimedia.org/wikipedia/en/5/56/Real_Madrid_CF.svg' }
        ]
      },
      clothing: {
        socks: [
          { id: 'c1', name: 'Comfort Socks', price: 12, image: 'https://cdn-icons-png.flaticon.com/512/1995/1995521.png' }
        ],
        shirts: [
          { id: 'c2', name: 'Casual Shirt', price: 25, image: 'https://cdn-icons-png.flaticon.com/512/892/892458.png' }
        ],
        tshirts: [
          { id: 'c3', name: 'Graphic T-Shirt', price: 18, image: 'https://cdn-icons-png.flaticon.com/512/892/892458.png' }
        ],
        pants: [
          { id: 'c4', name: 'Jeans', price: 40, image: 'https://cdn-icons-png.flaticon.com/512/892/892458.png' }
        ],
        shorts: [
          { id: 'c5', name: 'Casual Shorts', price: 22, image: 'https://cdn-icons-png.flaticon.com/512/892/892458.png' }
        ],
        swimShorts: [
          { id: 'c6', name: 'Swimming Shorts', price: 30, image: 'https://cdn-icons-png.flaticon.com/512/892/892458.png' }
        ]
      }
    }
  };

  // State variables
  let currentCategory = null;
  let currentSubcategory = null;
  let currentSubSubcategory = null;
  let cart = {};
  let discountApplied = false;
  let usedPromo = false;

  // DOM elements
  const sidebar = document.getElementById('sidebar');
  const sidebarToggle = document.getElementById('sidebarToggle');
  const mainContent = document.getElementById('mainContent');
  const cartToggle = document.getElementById('cartToggle');
  const cartOverlay = document.getElementById('cartOverlay');
  const cartItemsDiv = document.getElementById('cartItems');
  const checkoutTotal = document.getElementById('checkoutTotal');
  const promoInput = document.getElementById('promoInput');
  const promoBtn = document.getElementById('promoBtn');
  const promoMsg = document.getElementById('promoMsg');
  const searchInput = document.getElementById('searchInput');
  const priceFilter = document.getElementById('priceFilter');

  // Utility: Format price
  function formatPrice(num) {
    return `$${num.toFixed(2)}`;
  }

  // Show/hide sidebar
  sidebarToggle.addEventListener('click', () => {
    sidebar.classList.toggle('open');
    sidebar.setAttribute('aria-hidden', sidebar.classList.contains('open') ? 'false' : 'true');
  });

  // Clicking outside sidebar closes sidebar (optional)
  mainContent.addEventListener('click', () => {
    if (sidebar.classList.contains('open')) {
      sidebar.classList.remove('open');
      sidebar.setAttribute('aria-hidden', 'true');
    }
  });

  // Category buttons
  document.querySelectorAll('#sidebar button.category-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      // Toggle subcats visibility
      if (btn.id === 'catVirtual') {
        toggleSubcat('virtualSubcats');
        hideSubcat('physicalSubcats');
        hideSubcat('footballSubsubcats');
        hideSubcat('clothingSubsubcats');
      } else if (btn.id === 'catPhysical') {
        toggleSubcat('physicalSubcats');
        hideSubcat('virtualSubcats');
      }
      // Mark active category
      document.querySelectorAll('#sidebar button.category-btn').forEach(b => {
        b.classList.remove('active');
        b.setAttribute('aria-pressed', 'false');
      });
      btn.classList.add('active');
      btn.setAttribute('aria-pressed', 'true');
      currentCategory = btn.id === 'catVirtual' ? 'virtual' : 'physical';
      // Reset deeper selections
      currentSubcategory = null;
      currentSubSubcategory = null;
      renderProducts();
    });
  });

  // Subcategory buttons
  document.querySelectorAll('#sidebar button.subcat-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const subcat = btn.dataset.subcat;
      currentSubcategory = subcat;

      // Show/hide subsubcats for physical
      if (subcat === 'football') {
        showSubcat('footballSubsubcats');
        hideSubcat('clothingSubsubcats');
      } else if (subcat === 'clothing') {
        showSubcat('clothingSubsubcats');
        hideSubcat('footballSubsubcats');
      } else {
        hideSubcat('footballSubsubcats');
        hideSubcat('clothingSubsubcats');
      }

      // Mark active subcat
      document.querySelectorAll('#sidebar button.subcat-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // Reset subsubcat
      currentSubSubcategory = null;
      renderProducts();
    });
  });

  // Subsubcategory buttons
  document.querySelectorAll('#sidebar button.subsubcat-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const subsubcat = btn.dataset.subsubcat;
      currentSubSubcategory = subsubcat;

      // Mark active subsubcat
      document.querySelectorAll('#sidebar button.subsubcat-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      renderProducts();
    });
  });

  // Helpers to show/hide subcat/subsubcat divs
  function toggleSubcat(id) {
    const el = document.getElementById(id);
    if (!el) return;
    if (el.style.display === 'block') el.style.display = 'none';
    else el.style.display = 'block';
  }
  function showSubcat(id) {
    const el = document.getElementById(id);
    if (!el) return;
    el.style.display = 'block';
  }
  function hideSubcat(id) {
    const el = document.getElementById(id);
    if (!el) return;
    el.style.display = 'none';
  }

  // Render products based on current selections and filters
  function renderProducts() {
    let products = [];

    if (!currentCategory) {
      document.getElementById('products').innerHTML = '<p style="grid-column: span 3; text-align:center; color:#555;">Please select a category to see products.</p>';
      return;
    }

    if (currentCategory === 'virtual') {
      if (!currentSubcategory) {
        document.getElementById('products').innerHTML = '<p style="grid-column: span 3; text-align:center; color:#555;">Please select a virtual product type.</p>';
        return;
      }
      products = productsData.virtual[currentSubcategory] || [];
    } else if (currentCategory === 'physical') {
      if (!currentSubcategory) {
        document.getElementById('products').innerHTML = '<p style="grid-column: span 3; text-align:center; color:#555;">Please select a physical product type.</p>';
        return;
      }
      if (currentSubSubcategory) {
        products = (productsData.physical[currentSubcategory] && productsData.physical[currentSubcategory][currentSubSubcategory]) || [];
      } else {
        // Show all products under subcategory combined if no subsubcat selected
        const subcatObj = productsData.physical[currentSubcategory];
        if (subcatObj) {
          products = Object.values(subcatObj).flat();
        }
      }
    }

    // Apply search filter
    const searchTerm = searchInput.value.trim().toLowerCase();
    if (searchTerm) {
      products = products.filter(p => p.name.toLowerCase().includes(searchTerm));
    }

    // Apply price filter
    const priceVal = priceFilter.value;
    if (priceVal !== 'all') {
      products = products.filter(p => {
        if (priceVal === '0-20') return p.price < 20;
        if (priceVal === '20-50') return p.price >= 20 && p.price <= 50;
        if (priceVal === '50-100') return p.price > 50 && p.price <= 100;
        if (priceVal === '100+') return p.price > 100;
        return true;
      });
    }

    // Limit products to 12 max for demo
    products = products.slice(0, 12);

    // Render HTML
    if (products.length === 0) {
      document.getElementById('products').innerHTML = '<p style="grid-column: span 3; text-align:center; color:#555;">No products found.</p>';
      return;
    }
    const html = products.map(p => `
      <article tabindex="0" class="product-item" role="button" aria-pressed="false" aria-label="Add ${p.name} to cart" data-id="${p.id}">
        <img src="${p.image}" alt="${p.name}" loading="lazy" />
        <div class="product-name">${p.name}</div>
        <div class="price">${formatPrice(p.price)}</div>
      </article>
    `).join('');
    document.getElementById('products').innerHTML = html;

    // Add click handlers to add to cart
    document.querySelectorAll('.product-item').forEach(el => {
      el.addEventListener('click', () => {
        const id = el.dataset.id;
        addToCart(id);
      });
      el.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          const id = el.dataset.id;
          addToCart(id);
        }
      });
    });
  }

  // Get product info by id
  function getProductById(id) {
    for (const catKey in productsData) {
      const cat = productsData[catKey];
      if (catKey === 'virtual') {
        for (const subcatKey in cat) {
          const arr = cat[subcatKey];
          for (const p of arr) if (p.id === id) return p;
        }
      } else if (catKey === 'physical') {
        for (const subcatKey in cat) {
          const subcat = cat[subcatKey];
          for (const subsubcatKey in subcat) {
            const arr = subcat[subsubcatKey];
            for (const p of arr) if (p.id === id) return p;
          }
        }
      }
    }
    return null;
  }

  // Add to cart logic
  function addToCart(id) {
    if (!cart[id]) cart[id] = 1;
    else cart[id]++;
    updateCartUI();
    openCart();
  }

  // Update cart UI
  function updateCartUI() {
    cartItemsDiv.innerHTML = '';
    let total = 0;

    if (Object.keys(cart).length === 0) {
      cartItemsDiv.innerHTML = '<p>Your cart is empty.</p>';
      checkoutTotal.textContent = 'Total: $0.00';
      promoMsg.textContent = '';
      discountApplied = false;
      usedPromo = false;
      promoInput.value = '';
      promoInput.disabled = false;
      promoBtn.disabled = false;
      return;
    }

    for (const id in cart) {
      const qty = cart[id];
      const p = getProductById(id);
      if (!p) continue;
      total += p.price * qty;

      const item = document.createElement('div');
      item.className = 'cart-item';
      item.setAttribute('role', 'listitem');
      item.innerHTML = `
        <img src="${p.image}" alt="${p.name}" />
        <div class="cart-item-info">
          <div class="cart-item-name">${p.name}</div>
          <div class="cart-item-price">${formatPrice(p.price)}</div>
        </div>
        <div class="cart-quantity">
          <button class="qty-btn" aria-label="Decrease quantity of ${p.name}" data-id="${id}" data-action="decrease">âˆ’</button>
          <input class="qty-input" type="number" min="1" max="999" aria-label="Quantity of ${p.name}" data-id="${id}" value="${qty}" />
          <button class="qty-btn" aria-label="Increase quantity of ${p.name}" data-id="${id}" data-action="increase">+</button>
        </div>
      `;
      cartItemsDiv.appendChild(item);
    }

    // Apply discount if any
    if (discountApplied) total *= 0.85;

    checkoutTotal.textContent = `Total: ${formatPrice(total)}`;
  }

  // Open/close cart
  function openCart() {
    cartOverlay.classList.add('visible');
    cartOverlay.setAttribute('aria-hidden', 'false');
    cartToggle.classList.add('hidden');
  }
  function closeCart() {
    cartOverlay.classList.remove('visible');
    cartOverlay.setAttribute('aria-hidden', 'true');
    cartToggle.classList.remove('hidden');
  }

  // Cart toggle button
  cartToggle.addEventListener('click', () => {
    if (cartOverlay.classList.contains('visible')) closeCart();
    else openCart();
  });

  // Clicking outside cart closes it
  mainContent.addEventListener('click', () => {
    if (cartOverlay.classList.contains('visible')) {
      closeCart();
    }
  });

  // Stop clicks inside cart from closing
  cartOverlay.addEventListener('click', e => {
    e.stopPropagation();
  });

  // Quantity buttons & input handler (event delegation)
  cartItemsDiv.addEventListener('click', e => {
    if (!e.target.classList.contains('qty-btn')) return;
    const id = e.target.dataset.id;
    const action = e.target.dataset.action;
    if (!id || !action) return;
    if (!cart[id]) return;

    if (action === 'increase') {
      if (cart[id] < 999) cart[id]++;
    } else if (action === 'decrease') {
      if (cart[id] > 1) cart[id]--;
    }
    updateCartUI();
  });

  cartItemsDiv.addEventListener('input', e => {
    if (!e.target.classList.contains('qty-input')) return;
    const id = e.target.dataset.id;
    if (!id) return;
    let val = parseInt(e.target.value);
    if (isNaN(val) || val < 1) val = 1;
    if (val > 999) val = 999;
    cart[id] = val;
    updateCartUI();
  });

  // Promo code logic
  promoBtn.addEventListener('click', () => {
    const code = promoInput.value.trim().toLowerCase();
    if (!code) {
      promoMsg.textContent = 'Please enter a promo code.';
      return;
    }
    if (usedPromo) {
      promoMsg.textContent = 'Promo code already used.';
      return;
    }
    if (code === 'fortnite15') {
      discountApplied = true;
      usedPromo = true;
      promoMsg.textContent = 'Promo code applied! 15% discount.';
      promoInput.disabled = true;
      promoBtn.disabled = true;
      updateCartUI();
    } else {
      promoMsg.textContent = 'Invalid promo code.';
    }
  });

  // Search and filter listeners
  searchInput.addEventListener('input', renderProducts);
  priceFilter.addEventListener('change', renderProducts);

  // Initialize by selecting the first category
  document.getElementById('catVirtual').click();
</script>
</body>
</html>
